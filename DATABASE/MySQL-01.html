<!DOCTYPE html>
<html>
 <head><link rel="stylesheet" type="text/css" href="style.css"></head>
 
<body>
<h1 id="databaseの役割について">DataBaseの役割について</h1>
<p>時間の都合上、パワポを埋め込めることができませんでした。。。</p>
<h1 id="mysqlをインストールしよう">MySQLをインストールしよう！</h1>
<h2 id="事前準備">事前準備</h2>
<p>Red Hatは7系から標準搭載のDBはMariaDBとなっています。</p>
<p>MySQLを利用するにはまず競合するMariaDBを削除してやりましょう。</p>
<p>MariaDBはデフォルトでyumのリポジトリに登録されています。</p>
<p>ので、yumから消せます。 まずは登録情報を見てみましょう。</p>
<pre class="shell-session"><code>[root@relay-server ec2-user]# yum list installed  | grep maria

mariadb-libs.x86_64                   1:5.5.56-2.el7
@anaconda/7.4
</code></pre>
<p>ふむ。確かにいますね。 ではremoveしましょう。</p>
<pre class="shell-session"><code>[root@relay-server ec2-user]# yum removes mariadb-libs.x86_64

読み込んだプラグイン:amazon-id, rhui-lb, search-disabled-repos

コマンド「removes」が見つかりません。「/bin/yum --help」を実行してください。

[root@relay-server ec2-user]# yum remove mariadb-libs.x86_64

読み込んだプラグイン:amazon-id, rhui-lb, search-disabled-repos

依存性の解決をしています

--&gt; トランザクションの確認を実行しています。

---&gt; パッケージ mariadb-libs.x86_64 1:5.5.56-2.el7 を 削除

--&gt; 依存性の処理をしています: libmysqlclient.so.18()(64bit) のパッケージ:
2:postfix-2.10.1-6.el7.x86_64

--&gt; 依存性の処理をしています: libmysqlclient.so.18(libmysqlclient_18)(64bit) のパッケージ:
2:postfix-2.10.1-6.el7.x86_64

--&gt; トランザクションの確認を実行しています。

---&gt; パッケージ postfix.x86_64 2:2.10.1-6.el7 を 削除

--&gt; 依存性解決を終了しました。


依存性を解決しました


================================================================================

 Package            アーキテクチャー

                                 バージョン           リポジトリー         容量

================================================================================

削除中:

 mariadb-libs       x86_64       1:5.5.56-2.el7       @anaconda/7.4
4.4 M

依存性関連での削除をします:

 postfix            x86_64       2:2.10.1-6.el7       @anaconda/7.4
12 M


トランザクションの要約

================================================================================

削除  1 パッケージ (+1 個の依存関係のパッケージ)


インストール容量: 17 M

上記の処理を行います。よろしいでしょうか？ [y/N</code></pre>
<p>ここまでできたかな？ ここで処理実行内容を確認しましょう。</p>
<p>「y」キーを押下します。</p>
<pre><code>上記の処理を行います。よろしいでしょうか？ [y/N]y

Downloading packages:

Running transaction check

Running transaction test

Transaction test succeeded

Running transaction

  削除中                  : 2:postfix-2.10.1-6.el7.x86_64
1/2

  削除中                  : 1:mariadb-libs-5.5.56-2.el7.x86_64
2/2

  検証中                  : 1:mariadb-libs-5.5.56-2.el7.x86_64
1/2

  検証中                  : 2:postfix-2.10.1-6.el7.x86_64
2/2


削除しました:

  mariadb-libs.x86_64 1:5.5.56-2.el7



依存性の削除をしました:

  postfix.x86_64 2:2.10.1-6.el7



完了しました!
</code></pre>
<p>処理できたようですね。</p>
<p>あと、お掃除という意味合いでMariaDBのディレクトリも削除しておきましょう。</p>
<p>不要ディレクトリがあると、後続の参入メンバーが混乱する場合があります。</p>
<pre><code>rm -rf /var/lib/mysql/
</code></pre>
<p>sudo rpm -Uvh http://dev.mysql.com/get/ mysql80-community-release-el7-1.noarch.rpm</p>
<p>次に、以下のコマンドを実行してみてください。</p>
<pre class="shell-session"><code>
yum repolist all | grep mysql
</code></pre>
<p>次のような結果が得られるはずです。</p>
<pre class="shell-session"><code>
[root@relay-server ec2-user]# yum repolist all | grep mysql

mysql-cluster-7.5-community/x86_64                          MySQL C 無効

mysql-cluster-7.5-community-source                          MySQL C 無効

mysql-cluster-7.6-community/x86_64                          MySQL C 無効

mysql-cluster-7.6-community-source                          MySQL C 無効

!mysql-connectors-community/x86_64                          MySQL C 有効:
51

mysql-connectors-community-source                           MySQL C 無効

!mysql-tools-community/x86_64                               MySQL T 有効:
63

mysql-tools-community-source                                MySQL T 無効

mysql-tools-preview/x86_64                                  MySQL T 無効

mysql-tools-preview-source                                  MySQL T 無効

mysql55-community/x86_64                                    MySQL 5 無効

mysql55-community-source                                    MySQL 5 無効

mysql56-community/x86_64                                    MySQL 5 無効

mysql56-community-source                                    MySQL 5 無効

mysql57-community/x86_64                                    MySQL 5 無効

mysql57-community-source                                    MySQL 5 無効

!mysql80-community/x86_64                                   MySQL 8 有効:
17

mysql80-community-source                                    MySQL 8 無効
</code></pre>
<p>ここで、無効／有効と表記のある列があります。</p>
<p>これはリポジトリが有効か、無効かを示します。</p>
<p>yumのリポジトリがわからない人はググって調べてみよう。</p>
<p>上記コマンドの実行結果を見ると、</p>
<p>今回利用したい、MySQL5.7のリポジトリが無効になっている。</p>
<p>mysql57-community/x86_64 MySQL 5 無効 こいつら</p>
<p>mysql57-community-source MySQL 5 無効 こいつ</p>
<p>これを有効にする必要がある。</p>
<p>その前に、「yumdownloader」を利用したいので「yum-utils」をインストールします。</p>
<pre class="shell-session"><code>
yum -y install yum-utils
</code></pre>
<p>準備が整ったのでリポジトリを有効にします。</p>
<pre class="shell-session"><code>
yum-config-manager —enable mysql57-community
</code></pre>
<p>有効になったかを確認します。</p>
<pre class="shell-session"><code>
[root@relay-server ec2-user]# yum repolist all | grep mysql

mysql-cluster-7.5-community/x86_64                          MySQL C 無効

mysql-cluster-7.5-community-source                          MySQL C 無効

mysql-cluster-7.6-community/x86_64                          MySQL C 無効

mysql-cluster-7.6-community-source                          MySQL C 無効

mysql-connectors-community/x86_64                           MySQL C 有効:
51

mysql-connectors-community-source                           MySQL C 無効

mysql-tools-community/x86_64                                MySQL T 有効:
63

mysql-tools-community-source                                MySQL T 無効

mysql-tools-preview/x86_64                                  MySQL T 無効

mysql-tools-preview-source                                  MySQL T 無効

mysql55-community/x86_64                                    MySQL 5 無効

mysql55-community-source                                    MySQL 5 無効

mysql56-community/x86_64                                    MySQL 5 無効

mysql56-community-source                                    MySQL 5 無効

mysql57-community/x86_64                                    MySQL 5 有効:
267

mysql57-community-source                                    MySQL 5 無効

mysql80-community/x86_64                                    MySQL 8 有効:
17

mysql80-community-source                                    MySQL 8 無効

[root@relay-server ec2-user]#
</code></pre>
<p>どうでしょうか。有効になってましたか？</p>
<p>次は8系を利用しないために、以下のコマンドを実行</p>
<pre class="shell-session"><code>
yum-config-manager —disable mysql80-community
</code></pre>
<p>これで8系は無効になったはずです。</p>
<p>もう一度「yum-repolist」コマンドで確認してみよう。</p>
<pre class="shell-session"><code>
[root@relay-server ec2-user]# yum repolist all | grep mysql

mysql-cluster-7.5-community/x86_64                          MySQL C 無効

mysql-cluster-7.5-community-source                          MySQL C 無効

mysql-cluster-7.6-community/x86_64                          MySQL C 無効

mysql-cluster-7.6-community-source                          MySQL C 無効

mysql-connectors-community/x86_64                           MySQL C 有効:
51

mysql-connectors-community-source                           MySQL C 無効

mysql-tools-community/x86_64                                MySQL T 有効:
63

mysql-tools-community-source                                MySQL T 無効

mysql-tools-preview/x86_64                                  MySQL T 無効

mysql-tools-preview-source                                  MySQL T 無効

mysql55-community/x86_64                                    MySQL 5 無効

mysql55-community-source                                    MySQL 5 無効

mysql56-community/x86_64                                    MySQL 5 無効

mysql56-community-source                                    MySQL 5 無効

mysql57-community/x86_64                                    MySQL 5 有効:
267

mysql57-community-source                                    MySQL 5 無効

mysql80-community/x86_64                                    MySQL 8 無効

mysql80-community-source                                    MySQL 8 無効

[root@relay-server ec2-user]#

</code></pre>
<p>では</p>
<p>リポジトリを追加したので、パッケージを利用できるようになっているはずです。</p>
<p>ここで、MySQLのパッケージについて紹介しましょう。</p>
<p>MySQLには、以下の4タイプがあります。</p>
<p>1.MySQL Standard Edition</p>
<p>2.MySQL Enterprise Edition</p>
<p>3.MySQL Cluster Carrier Grade Edition</p>
<p>4.MySQL Community Server</p>
<p>名前でだいたい検討がつきますが、1～3の方は、有償であり、</p>
<p>サポートと、様々なツールが付随します。</p>
<p>4は無償ダウンロードが可能ですので、今回は、そちらを利用します。</p>
<p>ちなみに以下のページがMySQL Editionに関する詳細ページとなります。</p>
<p>https://www.mysql.com/jp/products/</p>
<p>パッケージの内容を覗いてみましょう。</p>
<p>以下のコマンドを実行してみてください。</p>
<pre class="shell-session"><code>
 yum info mysql-community-server
</code></pre>
<p>なんかでましたか？</p>
<p>「バージョン」項目が8系のままだとさっきのリポジトリの有効／無効がうまくいってないかもしれませんね。</p>
<p>余談はさておき、無償版をインストールしましょう。</p>
<h2 id="mysqlインストール">MySQLインストール</h2>
<p>以下のコマンドを実行して、MySQLを実行してみましょう。</p>
<pre class="shell-session"><code>
yum -y install mysql-community-server
</code></pre>
<p>完了したかな？</p>
<p>完了したら、コマンドを打って、バージョン情報を確認してみましょう。</p>
<pre class="shell-session"><code>
mysql —version
</code></pre>
<p>以下のように出力されればOKです！</p>
<pre class="shell-session"><code>
mysqld  Ver 5.7.22 for Linux on x86_64 (MySQL Community Server (GPL))
</code></pre>
<p>5.7系がちゃんとインストールできていれば、今回インストールしたい</p>
<p>バージョンのMySQLがちゃんとインストールできたことになります。</p>
<h2 id="mysqlの自動起動設定">MySQLの自動起動設定</h2>
<p>サーバをシャットダウンした際に、サービス（MySQL）が自動的に</p>
<p>実行されるととても楽である。</p>
<p>ということでサービスの自動起動をONにしましょう。</p>
<p>chkconfig mysql on</p>
<p>※chkconfig の「on」オプションでは、ランレベルとしては全て有効状態です。</p>
<p>「ランレベル」がわからない人はググってみよう。</p>
</body>
